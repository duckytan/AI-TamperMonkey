# Idle Pixel Auto 用户脚本

一个基于 Tampermonkey 的浏览器用户脚本。安装后会在目标网页中注入“设置与控制面板”，帮助你自动化完成重复性操作，并提供安全保护、错误恢复与可视化调试能力。

## 适用人群
- 完全没有脚本/编程基础的新手用户
- 希望在网页/游戏中自动化重复点击、资源收集、定时执行等任务的用户
- 想要在自动化的同时保留安全监控和手动干预能力的用户

## 功能总览
- 矿石熔炼自动化与熔炉启动：自动选择矿石、设置数量，完成后继续下一批。
- 油泵平衡：按设定节奏进行开关与流量平衡，避免溢出或枯竭。
- 船只派遣与收集：定时派船、回收，按策略周转资源。
- 伐木自动化：自动寻找目标按钮并按频率执行点击采集。
- 战斗自动化：在安全阈值与冷却时间内自动执行战斗或收尾。
- 陷阱与动物收集：定时巡检并自动收取产出。
- 定时与错误重启：定时重启脚本或遇错自动重启，保持长期稳定。
- 健康检查与 URL 监控：检测页面/服务状态并按需重启。
- WebSocket 消息：内部通信用于状态同步与事件响应。
- 动态页面监控（MutationObserver）：精准跟踪 DOM 变化避免盲点。
- 设置面板与分组开关：图形化开关/参数输入，配置持久化。
- 调试控制台与日志等级：多级日志与内置调试面板，便于排错。

## 运行环境
- 浏览器：Chrome、Edge、Firefox（建议最新版）
- 插件：Tampermonkey 扩展（最新版）
- 权限：仅在你允许的网站上运行；配置保存在浏览器本地 localStorage

## 安装步骤（零基础可用）
1. 安装 Tampermonkey
   - Chrome/Edge：扩展商店搜索“Tampermonkey”并安装
   - Firefox：Add-ons 搜索“Tampermonkey”并安装
2. 安装本脚本（手动安装）
   - 点击浏览器工具栏中的 Tampermonkey 图标 → 添加新脚本
   - 删除默认示例代码，将本仓库用户脚本源码全部粘贴进去
   - 文件 → 保存（或 Ctrl/Cmd + S）
   - 确认脚本已启用（列表中开关为 ON）
3. 启用脚本
   - 打开目标网站/游戏页面
   - 确认 Tampermonkey 图标上出现数字或脚本显示“已运行”
   - 页面将注入“设置与控制面板”（通常在页面边缘或可通过菜单打开）

## 首次使用与界面说明
- 面板区域（名称以实际为准）：
  - 功能分组开关：按“熔炼/油泵/船只/伐木/战斗/陷阱”等分组，每组含总开关与参数。
  - 参数设置：数量、间隔（毫秒/秒）、策略（随机/轮询）、安全阈值、重试次数等。
  - 运行控制：开始/暂停/重启按钮与状态指示（运行中/暂停/异常）。
  - 日志与调试：实时日志窗口与“调试控制台”，可选日志等级 error/warn/info/debug/trace。
  - 保存/重置：保存配置到浏览器或重置为默认值。
- 配置持久化：设置自动保存到 localStorage；刷新后仍保留。
- 恢复默认：使用“重置”或清除站点数据（会丢失配置）。

## 快速上手（5 分钟）
1) 打开目标页面并确认脚本在运行
2) 打开设置面板
3) 开启所需功能分组（例：矿石熔炼）
4) 设置关键参数（如每批数量、最小间隔）
5) 点击“开始”或“保存并运行”
6) 观察日志确保无错误或防护触发
7) 需要暂停随时点击“暂停”；遇异常可“一键重启”

---

## 功能与使用教程（逐项）
下列每项包含：作用、前置要求、推荐设置、操作步骤、安全与常见问题。

### 1) 矿石熔炼自动化与熔炉启动
- 作用：自动选择矿石并批量熔炼；完成后继续下一批。
- 前置要求：页面存在矿石选择、数量输入与熔炉启动/确认控件。
- 推荐设置：
  - 批量数量：依据背包容量与熔炉速度；新手从小批量开始。
  - 间隔时间：建议 ≥ 500ms，避免过快点击触发封禁策略。
  - 重试次数：2–3 次；失败触发错误恢复或重启。
- 操作步骤：
  1. 打开“矿石熔炼”分组并开启总开关
  2. 选择矿石来源（随机/固定）
  3. 设置单批数量与批次上限（不限/固定次数）
  4. 开启“自动启动熔炉”“完成后继续”
  5. 点击“开始”或保存设置
- 安全与常见问题：
  - 找不到元素时会等待并记录日志，不会盲点。
  - UI 改版可能导致定位失败；查看日志并更新选择器配置。
  - 卡住时启用“错误重启”以自动恢复。

### 2) 油泵平衡
- 作用：按设定频率自动开启/关闭/切换，保证产出稳定且不过流。
- 前置要求：页面有油泵控制按钮与状态指标。
- 推荐设置：先保守的间隔与阈值，观察日志后再优化。
- 操作步骤：
  1. 开启“油泵平衡”，设置目标阈值与检测间隔
  2. 启用“自动平衡”与保护（如“高负载暂停”）
  3. 运行并观察短期效果
- 安全：超限（高温/过压）时自动暂停并报警。

### 3) 船只派遣与收集
- 作用：按策略派船与回收，支持定时与条件触发。
- 前置要求：页面存在派遣/收回入口与状态显示。
- 推荐设置：先小批量测试策略（随机/轮询），确认不触发限制后再扩大。
- 操作步骤：
  1. 启用“船只”分组，选择策略（按队列/按收益/随机）
  2. 设置派遣间隔、最小收益阈值、最大并发
  3. 开启“自动回收”和“失败重试”
  4. 运行并观察日志
- 安全：加入随机延迟，达到并发或库存上限时自动减速或暂停。

### 4) 伐木自动化
- 作用：自动定位伐木按钮/区域并按频率执行采集。
- 前置要求：页面元素可被准确识别。
- 推荐设置：中等频率与随机抖动，降低被识别为机器人风险。
- 操作步骤：
  1. 启用“伐木”，设置采集频率与随机延迟范围
  2. 可选：指定目标区域/优先级
  3. 运行并观察产出与日志
- 安全：元素缺失或延迟过高时暂停并重试。

### 5) 战斗自动化
- 作用：在安全阈值下自动发起/收尾。
- 前置要求：战斗入口/状态可被检测。
- 推荐设置：严格的冷却、生命/资源阈值，先保守后优化。
- 操作步骤：
  1. 开启“战斗”，设置冷却、生命/资源阈值
  2. 启用“失败重试”“安全暂停”
  3. 启动后观察战斗日志
- 安全：不满足安全阈值时自动暂停或放弃本轮。

### 6) 陷阱与动物收集
- 作用：定时巡检陷阱/动物状态并自动收集。
- 前置要求：页面可识别“可收集/冷却中”状态。
- 推荐设置：合理巡检间隔，避免频繁无效检查。
- 操作步骤：
  1. 开启“陷阱&动物”，设置巡检间隔与每次最大收集数
  2. 选择“完成即停止”或“循环模式”
  3. 开始运行
- 安全：连续失败时加长重试间隔或切换保守模式。

### 7) 定时与错误重启、健康检查
- 作用：保障长时间运行稳定，出错自动恢复。
- 前置要求：可选配置健康检查 URL。
- 推荐设置：每 2–6 小时定时重启；设置合理错误阈值。
- 操作步骤：
  1. 打开“重启与健康”，设置重启间隔
  2. 配置健康检查地址（可选）
  3. 启用“错误达到阈值即重启”
  4. 保存生效
- 安全：重启前保存配置；重启后自动恢复运行状态（如启用）。

### 8) WebSocket 消息（进阶）
- 用于内部通信/状态同步；普通用户无需更改。
- 网络不支持时自动降级到定时轮询，并记录日志。

### 9) 动态页面监控（MutationObserver）
- 监听页面 DOM 变化，精准判断元素出现/状态改变。
- 网站重大改版时可能需更新选择器（日志会提示）。

### 10) 设置面板与分组开关
- 常用按钮：
  - 开始：按当前配置开始自动化
  - 暂停：临时停止所有动作
  - 重启：重启内部计时与状态机
  - 保存：保存配置到 localStorage
  - 重置：恢复默认配置（谨慎）
- 状态指示：显示运行状态、最后动作时间、异常计数等。

### 11) 调试控制台与日志等级
- 日志等级：error < warn < info < debug < trace（从少到多）
- 建议：
  - 正常运行使用 info
  - 排错时用 debug/trace（完成后改回）
- 可在面板查看日志或打开浏览器开发者工具。

## 常见问题（FAQ）
- 面板没有出现？
  - 确认脚本在当前站点启用；刷新页面；检查浏览器控制台报错；确认未被其他扩展拦截。
- 点击不到按钮/提示“未找到元素”？
  - 可能 UI 改版或加载延迟。等待几秒；调大等待时间；根据日志更新选择器。
- 运行很卡/占用高？
  - 降低并发与频率；日志等级调至 info；关闭不必要功能。
- 会违反网站规则吗？
  - 请遵守目标网站/游戏条款。合理设置频率与随机延迟，避免激进行为。
- 如何备份/恢复配置？
  - 配置存于 localStorage；可在面板提供导入/导出（若有）或用浏览器导出站点数据。

## 进阶设置与建议
- 频率与随机延迟：为高频操作加入最小间隔与随机抖动降低一致性。
- 容错与重试：为非关键操作设置有限重试，失败后退一步（暂停或拉长间隔）。
- 黑/白名单网址：仅在明确域名/路径上启用脚本，避免误触发。
- 长时间运行：开启定时重启与健康检查，保障多小时/多天稳定性。

## 更新与版本
- Tampermonkey 会定期检查更新；也可在面板或脚本管理页手动检查。
- 手动安装更新：重复“复制粘贴 → 保存”。
- 更新后请查看变更说明或面板公告。

## 开发者须知（可选）
- 代码结构（IIFE + 模块）：
  - 日志模块：统一日志等级与输出
  - 配置持久化：读写 localStorage，初始化默认值
  - 资源清理：定时器、监听器、WebSocket 的创建与释放
  - 工具与 DOM 选择器：元素查找/等待、节流/防抖等
  - 炼矿助手：与熔炼流程相关的封装
  - 功能管理器：调度分组功能、定时任务、WebSocket、MutationObserver、错误恢复、面板生成
- 添加新功能：
  1. 定义分组配置项与默认参数
  2. 在面板中注册开关与输入控件
  3. 实现核心逻辑（含安全检查与错误恢复）
  4. 纳入功能管理器的启动/暂停/重启流程
  5. 编写日志输出与用户提示

## 安全与免责声明
- 使用前请阅读并遵守目标网站/游戏的服务条款与法律法规。
- 适度使用自动化，尽量模拟正常的人类行为频率。
- 本脚本按“现状”提供，对因使用导致的封禁或损失不承担责任；请自行评估风险。

## 许可证
- 许可证信息见仓库 LICENSE（如未提供，则以默认开源许可证为准）。

---

Acceptance criteria
- README.md 在仓库根目录存在并包含上述完整内容，结构清晰、Markdown 语法正确。
- 标题、分节、列表与代码块渲染正常；中文标点与空格规范化。
- 与脚本实际功能分组名称尽可能一致（如存在差异，以代码里 UI 文案为准做微调）。
- 提交信息：docs: rewrite README (zh) with detailed usage guide
